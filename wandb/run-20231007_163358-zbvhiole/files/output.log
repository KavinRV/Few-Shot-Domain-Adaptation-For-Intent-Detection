
Downloading readme: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 547/547 [00:00<00:00, 2.03MB/s]
Downloading data files:   0%|                                                                                                                                                                                           | 0/1 [00:00<?, ?it/s]


Downloading data files: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.97s/it]
Extracting data files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1335.34it/s]

Generating train split: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 138200/138200 [00:00<00:00, 321715.31 examples/s]
Downloading readme: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 545/545 [00:00<00:00, 2.58MB/s]
Downloading data files:   0%|                                                                                                                                                                                           | 0/1 [00:00<?, ?it/s]
Downloading data files: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.38s/it]
Extracting data files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1112.25it/s]
Generating train split: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 24160/24160 [00:00<00:00, 295321.87 examples/s]
Some weights of ReRanker were not initialized from the model checkpoint at cartesinus/xlm-r-base-amazon-massive-intent-label_smoothing and are newly initialized because the shapes did not match:
- classifier.out_proj.bias: found shape torch.Size([60]) in the checkpoint and torch.Size([1]) in the model instantiated
- classifier.out_proj.weight: found shape torch.Size([60, 768]) in the checkpoint and torch.Size([1, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                | 0/1605 [00:00<?, ?it/s]You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.




























  2%|███▋                                                                                                                                                                                                 | 30/1605 [07:20<6:24:15, 14.64s/it]
  1%|██▋                                                                                                                                                                                                      | 8/604 [00:01<01:43,  5.75it/s]

















































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 600/604 [01:36<00:00,  6.24it/s]





























  4%|███████▎                                                                                                                                                                                             | 60/1605 [16:22<6:12:22, 14.46s/it]
  1%|██▎                                                                                                                                                                                                      | 7/604 [00:00<01:35,  6.28it/s]

















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ | 601/604 [01:37<00:00,  6.20it/s]






























  6%|███████████                                                                                                                                                                                          | 90/1605 [25:24<6:09:53, 14.65s/it]
  2%|███▎                                                                                                                                                                                                    | 10/604 [00:01<01:35,  6.20it/s]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 596/604 [01:36<00:01,  6.25it/s]





























  7%|██████████████▋                                                                                                                                                                                     | 120/1605 [34:26<6:03:51, 14.70s/it]
  2%|███▎                                                                                                                                                                                                    | 10/604 [00:01<01:33,  6.33it/s]
















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 594/604 [01:35<00:01,  6.11it/s]





























  9%|██████████████████▏                                                                                                                                                                                 | 149/1605 [43:16<5:57:11, 14.72s/it]
  9%|██████████████████▎                                                                                                                                                                                 | 150/1605 [43:31<5:57:01, 14.72s/it]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 597/604 [01:36<00:01,  5.95it/s]






























 11%|█████████████████████▉                                                                                                                                                                              | 180/1605 [52:41<5:51:09, 14.79s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:41, 14.68it/s]

















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 603/604 [01:37<00:00,  6.30it/s]






























 13%|█████████████████████████▎                                                                                                                                                                        | 209/1605 [1:01:32<5:39:13, 14.58s/it]
 13%|█████████████████████████▍                                                                                                                                                                        | 210/1605 [1:01:46<5:39:04, 14.58s/it]
















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 593/604 [01:35<00:01,  5.98it/s]





























 15%|█████████████████████████████                                                                                                                                                                     | 240/1605 [1:10:48<5:29:12, 14.47s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:40, 14.91it/s]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 597/604 [01:36<00:01,  6.09it/s]































 17%|████████████████████████████████▋                                                                                                                                                                 | 270/1605 [1:19:49<5:24:30, 14.58s/it]
{'loss': 0.109, 'learning_rate': 1.663551401869159e-05, 'epoch': 2.5}















































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 598/604 [01:36<00:00,  6.17it/s]






























 19%|████████████████████████████████████▏                                                                                                                                                             | 299/1605 [1:28:36<5:18:49, 14.65s/it]
 19%|████████████████████████████████████▎                                                                                                                                                             | 300/1605 [1:28:50<5:17:44, 14.61s/it]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 596/604 [01:35<00:01,  6.25it/s]





























 21%|███████████████████████████████████████▉                                                                                                                                                          | 330/1605 [1:37:52<5:10:58, 14.63s/it]
  0%|                                                                                                                                                                                                                 | 0/604 [00:00<?, ?it/s]

















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 594/604 [01:36<00:01,  6.07it/s]






























 22%|███████████████████████████████████████████▌                                                                                                                                                      | 360/1605 [1:47:01<5:04:31, 14.68s/it]
{'loss': 0.0917, 'learning_rate': 1.5514018691588785e-05, 'epoch': 3.33}
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 596/604 [01:36<00:01,  5.92it/s]





























 24%|███████████████████████████████████████████████                                                                                                                                                   | 389/1605 [1:55:50<4:53:12, 14.47s/it]
 24%|███████████████████████████████████████████████▏                                                                                                                                                  | 390/1605 [1:56:04<4:53:41, 14.50s/it]
















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 593/604 [01:35<00:01,  5.96it/s]





























 26%|██████████████████████████████████████████████████▊                                                                                                                                               | 420/1605 [2:05:07<4:47:12, 14.54s/it]
  1%|██▉                                                                                                                                                                                                      | 9/604 [00:01<01:39,  5.95it/s]

















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 602/604 [01:37<00:00,  6.11it/s]





























 28%|██████████████████████████████████████████████████████▎                                                                                                                                           | 449/1605 [2:13:55<4:39:49, 14.52s/it]
 28%|██████████████████████████████████████████████████████▍                                                                                                                                           | 450/1605 [2:14:10<4:39:54, 14.54s/it]
















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 592/604 [01:35<00:01,  6.56it/s]





























 30%|█████████████████████████████████████████████████████████▉                                                                                                                                        | 479/1605 [2:22:59<4:35:39, 14.69s/it]
 30%|██████████████████████████████████████████████████████████                                                                                                                                        | 480/1605 [2:23:13<4:34:58, 14.67s/it]
















































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 598/604 [01:37<00:00,  6.09it/s]






























 32%|█████████████████████████████████████████████████████████████▋                                                                                                                                    | 510/1605 [2:32:19<4:28:41, 14.72s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:40, 14.76it/s]

















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 594/604 [01:36<00:01,  6.02it/s]





























 34%|█████████████████████████████████████████████████████████████████▏                                                                                                                                | 539/1605 [2:41:08<4:20:59, 14.69s/it]
 34%|█████████████████████████████████████████████████████████████████▎                                                                                                                                | 540/1605 [2:41:23<4:20:30, 14.68s/it]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 602/604 [01:36<00:00,  6.21it/s]






























 35%|████████████████████████████████████████████████████████████████████▊                                                                                                                             | 569/1605 [2:50:09<4:10:04, 14.48s/it]
 36%|████████████████████████████████████████████████████████████████████▉                                                                                                                             | 570/1605 [2:50:24<4:11:25, 14.58s/it]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 596/604 [01:36<00:01,  6.12it/s]






























 37%|████████████████████████████████████████████████████████████████████████▍                                                                                                                         | 599/1605 [2:59:12<4:02:25, 14.46s/it]
 37%|████████████████████████████████████████████████████████████████████████▌                                                                                                                         | 600/1605 [2:59:27<4:00:42, 14.37s/it]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 603/604 [01:36<00:00,  6.25it/s]






























 39%|████████████████████████████████████████████████████████████████████████████                                                                                                                      | 629/1605 [3:08:14<3:58:28, 14.66s/it]
 39%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                     | 630/1605 [3:08:29<3:58:55, 14.70s/it]
















































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 599/604 [01:37<00:00,  6.06it/s]






























 41%|███████████████████████████████████████████████████████████████████████████████▋                                                                                                                  | 659/1605 [3:17:19<3:51:59, 14.71s/it]
 41%|███████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 660/1605 [3:17:33<3:52:12, 14.74s/it]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ | 601/604 [01:37<00:00,  6.04it/s]






























 43%|███████████████████████████████████████████████████████████████████████████████████▍                                                                                                              | 690/1605 [3:26:39<3:44:21, 14.71s/it]
  1%|█▎                                                                                                                                                                                                       | 4/604 [00:00<01:10,  8.48it/s]

















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 603/604 [01:38<00:00,  6.23it/s]






























 45%|███████████████████████████████████████████████████████████████████████████████████████                                                                                                           | 720/1605 [3:35:46<3:37:08, 14.72s/it]
  1%|█▎                                                                                                                                                                                                       | 4/604 [00:00<01:13,  8.16it/s]


















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 603/604 [01:38<00:00,  6.22it/s]






























 47%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                       | 750/1605 [3:44:53<3:27:55, 14.59s/it]
  2%|███▉                                                                                                                                                                                                    | 12/604 [00:01<01:35,  6.22it/s]

















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 602/604 [01:38<00:00,  5.95it/s]





























 49%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 779/1605 [3:53:44<3:19:26, 14.49s/it]
 49%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                   | 780/1605 [3:53:59<3:18:42, 14.45s/it]
















































 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 593/604 [01:35<00:01,  5.97it/s]






























 50%|█████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                | 810/1605 [4:03:03<3:14:38, 14.69s/it]
{'loss': 0.028, 'learning_rate': 9.906542056074768e-06, 'epoch': 7.5}
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 603/604 [01:37<00:00,  6.25it/s]






























 52%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                            | 839/1605 [4:11:54<3:07:06, 14.66s/it]
 52%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                            | 840/1605 [4:12:09<3:06:25, 14.62s/it]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 595/604 [01:36<00:01,  6.28it/s]






























 54%|█████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                         | 869/1605 [4:20:59<2:59:52, 14.66s/it]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 870/1605 [4:21:14<2:58:37, 14.58s/it]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 603/604 [01:37<00:00,  6.31it/s]






























 56%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                     | 900/1605 [4:30:17<2:52:36, 14.69s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:40, 14.83it/s]
















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 597/604 [01:36<00:01,  6.05it/s]






























 58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                 | 929/1605 [4:39:04<2:43:00, 14.47s/it]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                 | 930/1605 [4:39:19<2:43:07, 14.50s/it]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 602/604 [01:37<00:00,  6.14it/s]






























 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                              | 959/1605 [4:48:11<2:38:37, 14.73s/it]
 60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                              | 960/1605 [4:48:25<2:37:52, 14.69s/it]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 602/604 [01:37<00:00,  6.03it/s]






























 62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                          | 990/1605 [4:57:33<2:30:02, 14.64s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:40, 14.82it/s]

















































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 595/604 [01:36<00:01,  6.15it/s]





























 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                      | 1020/1605 [5:06:38<2:22:02, 14.57s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:40, 14.81it/s]
















































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 602/604 [01:36<00:00,  6.13it/s]






























 65%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 1050/1605 [5:15:41<2:15:22, 14.63s/it]
  0%|▋                                                                                                                                                                                                        | 2/604 [00:00<00:41, 14.58it/s]












  File "/raid/kavin-intern-maunendra/GenRet/train_da.py", line 212, in <module>                                                                                                                             | 152/604 [00:24<01:12,  6.25it/s]
    trainer.train()
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 1539, in train
    return inner_training_loop(
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 1901, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 2226, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 2934, in evaluate
    output = eval_loop(
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 3123, in evaluation_loop
    loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 3337, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/transformers/trainer.py", line 2679, in compute_loss
    outputs = model(**inputs)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/kavin-intern-maunendra/GenRet/train_da.py", line 70, in forward
    wandb.log({"loss": loss})
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 419, in wrapper
    return func(self, *args, **kwargs)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 370, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 360, in wrapper
    return func(self, *args, **kwargs)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1792, in log
    self._log(data=data, step=step, commit=commit)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1567, in _log
    self._partial_history_callback(data, step, commit)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1439, in _partial_history_callback
    self._backend.interface.publish_partial_history(
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 540, in publish_partial_history
    item.value_json = json_dumps_safer_history(v)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/util.py", line 839, in json_dumps_safer_history
    return dumps(obj, cls=WandBHistoryJSONEncoder, **kwargs)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/util.py", line 800, in default
    obj, converted = json_friendly(obj)
  File "/raid/kavin-intern-maunendra/anaconda3/envs/wow/lib/python3.10/site-packages/wandb/util.py", line 612, in json_friendly
    return obj.item(), True
KeyboardInterrupt